<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Organization Signin Minimal Demo</title>
  <style>
    body { font-family: sans-serif; background: #f4f4f4; }
    main { max-width: 400px; margin: 3em auto; padding: 2em 1em; background: #fff; border-radius: 8px; box-shadow: 0 2px 12px rgba(0,0,0,0.08); }
    .btn { margin-top: 1em; padding: 0.5em 1.2em; }
    #org-form-section { display: none; }
    #add-org-section { display: none; margin-bottom: 1em; }
    #add-opportunity-container { display: none; margin: 1em 0; }
    #password-error { color: #b00020; margin-top: 1em; display: none; }
    #add-opportunity-message { color: #b00020; margin-top: 0.5em; display: none; }
  </style>
</head>
<body>
  <main>
    <div id="password-section">
      <h2>Organization Signin</h2>
      <form id="password-form" autocomplete="off">
        <input type="password" id="org-password" placeholder="Enter password" style="width:100%;padding:0.5em;"><br>
        <button type="submit" class="btn">Continue</button>
        <div id="password-error">Incorrect password. Please try again.</div>
      </form>
    </div>
    <div id="org-form-section">
      <h2>Organization Form</h2>
      <form id="org-form">
        <select id="org-dropdown" style="width:100%;padding:0.5em;margin-bottom:1em;">
          <option value="">-- Choose --</option>
          <option value="Indivisible">Indivisible</option>
          <option value="Bakers for Palestine">Bakers for Palestine</option>
          <option value="DSA">DSA</option>
          <option value="SLC Mutual Aid">SLC Mutual Aid</option>
          <option value="__add_new__">+ Add New Organization</option>
        </select><br>
        <div id="add-org-section">
          <input type="text" id="new-org-input" placeholder="Organization name" style="width:70%;padding:0.4em;">
          <button type="button" id="add-org-btn">Add</button>
          <div id="add-org-message" style="color:#b00020;margin-top:0.5em;display:none;"></div>
        </div>
        <div id="opportunities"></div>
        <button type="button" id="add-opportunity-btn" class="btn" style="background:#eee;color:#333;margin-bottom:0.5em;">Add New Opportunity</button>
        <div id="add-opportunity-container">
          <input type="text" id="new-opportunity-input" placeholder="Opportunity name" style="width:70%;padding:0.4em;">
          <button type="button" id="save-opportunity-btn">Save</button>
          <div id="add-opportunity-message"></div>
        </div>
        <button type="submit" class="btn">Submit</button>
      </form>
    </div>
  </main>
  <script>
    // Minimal password logic: demo password is "pass"
    const passwordForm = document.getElementById('password-form');
    const passwordInput = document.getElementById('org-password');
    const passwordError = document.getElementById('password-error');
    const passwordSection = document.getElementById('password-section');
    const orgFormSection = document.getElementById('org-form-section');

    passwordForm.addEventListener('submit', function(e) {
      e.preventDefault();
      if(passwordInput.value === "pass") {
        passwordSection.style.display = 'none';
        orgFormSection.style.display = 'block';
        passwordError.style.display = 'none';
        passwordInput.value = '';
      } else {
        passwordError.style.display = 'block';
        passwordInput.value = '';
      }
    });

    // Minimal orgs and opportunities logic
    const orgDropdown = document.getElementById('org-dropdown');
    const addOrgSection = document.getElementById('add-org-section');
    const addOrgBtn = document.getElementById('add-org-btn');
    const newOrgInput = document.getElementById('new-org-input');
    const addOrgMessage = document.getElementById('add-org-message');
    const opportunitiesDiv = document.getElementById('opportunities');
    const addOpportunityBtn = document.getElementById('add-opportunity-btn');
    const addOpportunityContainer = document.getElementById('add-opportunity-container');
    const newOpportunityInput = document.getElementById('new-opportunity-input');
    const saveOpportunityBtn = document.getElementById('save-opportunity-btn');
    const addOpportunityMessage = document.getElementById('add-opportunity-message');

    let currentOpportunities = [
      "Bake Sale","Protest Set up/ Teardown","Graphic Design","Social Media Boosting",
      "Letter Writing","Food Drive","Flyering","First Aid","Crowd Control","Speaking",
      "Info Booth Attendant","Screen Printing"
    ];

    function renderOpportunities(ops) {
      opportunitiesDiv.innerHTML = ops.map(op =>
        `<label><input type="checkbox" name="opportunities" value="${op}"> ${op}</label><br>`
      ).join("");
    }
    renderOpportunities(currentOpportunities);

    orgDropdown.addEventListener('change', function() {
      if(this.value === "__add_new__") {
        addOrgSection.style.display = "block";
      } else {
        addOrgSection.style.display = "none";
        renderOpportunities(currentOpportunities);
      }
    });

    addOrgBtn.addEventListener('click', function() {
      const name = newOrgInput.value.trim();
      if(!name) {
        addOrgMessage.textContent = "Organization name required.";
        addOrgMessage.style.display = "block";
        return;
      }
      addOrgMessage.style.display = "none";
      // Insert new org before "+ Add New Organization"
      const addNewOption = orgDropdown.querySelector('option[value="__add_new__"]');
      const option = document.createElement('option');
      option.value = name;
      option.textContent = name;
      orgDropdown.insertBefore(option, addNewOption);
      orgDropdown.value = name;
      addOrgSection.style.display = "none";
      newOrgInput.value = '';
      renderOpportunities(currentOpportunities);
    });

    // Add New Opportunity logic
    addOpportunityBtn.addEventListener('click', function() {
      addOpportunityContainer.style.display = "block";
      newOpportunityInput.value = "";
      addOpportunityMessage.style.display = "none";
      newOpportunityInput.focus();
    });

    saveOpportunityBtn.addEventListener('click', function() {
      const val = newOpportunityInput.value.trim();
      if(!val) {
        addOpportunityMessage.textContent = "Opportunity name required.";
        addOpportunityMessage.style.display = "block";
        return;
      }
      // Prevent duplicates
      if(currentOpportunities.includes(val)) {
        addOpportunityMessage.textContent = "That opportunity already exists.";
        addOpportunityMessage.style.display = "block";
        return;
      }
      addOpportunityMessage.style.display = "none";
      currentOpportunities.push(val);
      renderOpportunities(currentOpportunities);
      addOpportunityContainer.style.display = "none";
      newOpportunityInput.value = "";
    });

    document.getElementById('org-form').addEventListener('submit', function(e) {
      e.preventDefault();
      alert("Submitted for org: " + orgDropdown.value);
      location.reload();
    });
  </script>
</body>
</html>